name: swis-api CI/CD pipeline

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  redeploy:
    runs-on: [ self-hosted, stokrle ]

    steps:
    - uses: actions/checkout@v2
    - name: Redeploy docker container (makefile chain target)
      run: make run

  import:
    runs-on: [ self-hosted, stokrle ]

    steps:
    - uses: actions/checkout@v2
    - name: Import static data to production
      run: make import_prod_static_data
